<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stone Clicker Game - Fullscreen Blast</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: sans-serif;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            transition: background-color 0.5s; /* èƒŒæ™¯è‰²ã®å¤‰åŒ–ã‚’æ»‘ã‚‰ã‹ã« */
        }
        .content-wrapper { /* ãƒ†ã‚­ã‚¹ãƒˆã¨ç”»åƒã‚’ã¾ã¨ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒŠ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        #instruction {
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        #clickCountParagraph {
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        #stoneImage {
            cursor: pointer;
            width: 150px;
            max-width: 80%;
            height: auto;
            border: 2px solid black;
            border-radius: 10px;
            margin-bottom: 20px;
            transition: opacity 0.3s, transform 0.3s; /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ */
        }
        #stoneImage:hover {
            opacity: 0.8;
            transform: scale(1.05);
        }
        #myVideo {
            display: none; /* æœ€åˆã¯éè¡¨ç¤º */
            width: 90%;    /* ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã§ãªã„æ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚µã‚¤ã‚º */
            max-width: 800px; /* ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã§ãªã„æ™‚ã®æœ€å¤§å¹…ã‚’å°‘ã—å¤§ãã */
            margin-top: 10px;
            background-color: #000; /* ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³æ™‚ã«èƒŒæ™¯ãŒé»’ã«ãªã‚‹ã‚ˆã†ã« */
        }
        /* ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³æ™‚ã«ä»–ã®è¦ç´ ã‚’éš ã™ãŸã‚ã®ã‚¯ãƒ©ã‚¹ (JavaScriptã§æ“ä½œ) */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>

    <div id="contentWrapper" class="content-wrapper">
        <p id="instruction">ç ”ä¸€ã‚’100å›ã‚¿ãƒƒãƒ—ã—ã¦ï¼</p>
        <p id="clickCountParagraph">ç¾åœ¨ã®ã‚«ã‚¦ãƒ³ãƒˆ: <span id="clickCountDisplay">0</span> / 100</p>
        <img src="stone.png" id="stoneImage" alt="Click the Stone!">
    </div>

    <video id="myVideo"> <source src="D4372235-B49A-41E0-B864-C3957B4F8A9E.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <script>
        const stoneImage = document.getElementById('stoneImage');
        const videoPlayer = document.getElementById('myVideo');
        const clickCountDisplay = document.getElementById('clickCountDisplay');
        const instructionText = document.getElementById('instruction');
        const clickCountParagraph = document.getElementById('clickCountParagraph'); // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®æ®µè½å…¨ä½“
        const contentWrapper = document.getElementById('contentWrapper'); // ãƒ†ã‚­ã‚¹ãƒˆã¨ç”»åƒã‚’ã¾ã¨ã‚ã‚‹div

        let clicks = 0;
        const clicksForVideo = 30;
        const totalClicksGoal = 100;
        let videoHasPlayed = false;

        stoneImage.addEventListener('click', function() {
            if (clicks < totalClicksGoal) {
                clicks++;
                clickCountDisplay.textContent = clicks;
            }

            if (clicks >= clicksForVideo && !videoHasPlayed) {
                console.log("50 Clicks reached! Preparing video for fullscreen.");

                // ä»–ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤ºã«ã™ã‚‹
                contentWrapper.classList.add('hidden');

                videoPlayer.style.display = 'block'; // å‹•ç”»è¦ç´ ã‚’è¡¨ç¤ºçŠ¶æ…‹ã«ã™ã‚‹
                videoPlayer.volume = 1.0; // éŸ³é‡ã‚’æœ€å¤§ã« (ã“ã‚Œä»¥ä¸Šã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã¯ä¸å¯)

                // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºã‚’è©¦ã¿ã‚‹
                if (videoPlayer.requestFullscreen) {
                    videoPlayer.requestFullscreen().catch(err => console.error("Error attempting fullscreen:", err));
                } else if (videoPlayer.mozRequestFullScreen) { /* Firefox */
                    videoPlayer.mozRequestFullScreen().catch(err => console.error("Error attempting fullscreen (Firefox):", err));
                } else if (videoPlayer.webkitRequestFullscreen) { /* Chrome, Safari & Opera */
                    videoPlayer.webkitRequestFullscreen().catch(err => console.error("Error attempting fullscreen (WebKit):", err));
                } else if (videoPlayer.msRequestFullscreen) { /* IE/Edge */
                    videoPlayer.msRequestFullscreen().catch(err => console.error("Error attempting fullscreen (MS):", err));
                }

                videoPlayer.play()
                    .then(() => {
                        console.log("Video started playing.");
                        // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãŒæˆåŠŸã—ãŸå ´åˆã€ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯è¦‹ãˆãªã„å¯èƒ½æ€§ãŒé«˜ã„
                        // instructionText.textContent = "å‹•ç”»å†ç”Ÿä¸­ï¼"; // ãƒšãƒ¼ã‚¸ã«æ®‹ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã¯æ›´æ–°ã§ãã‚‹
                    })
                    .catch(error => {
                        console.error("Error attempting to play video:", error);
                        // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã«å¤±æ•—ã—ã¦ã‚‚ã€å‹•ç”»å†ç”Ÿã¯è©¦ã¿ã‚‰ã‚Œã‚‹
                        // ã‚¨ãƒ©ãƒ¼æ™‚ã‚„ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è§£é™¤æ™‚ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æˆ»ã™å‡¦ç†ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚‹
                        contentWrapper.classList.remove('hidden'); // ã‚¨ãƒ©ãƒ¼ãªã‚‰å…ƒã«æˆ»ã™
                        instructionText.textContent = "å‹•ç”»ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
                    });
                videoHasPlayed = true;
            }

            if (clicks >= totalClicksGoal && videoHasPlayed) { // å‹•ç”»å†ç”Ÿå¾Œã«100å›é”æˆ
                // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ä¸­ã¯è¦‹ãˆãªã„ãŒã€ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è§£é™¤å¾Œã‚„
                // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã«ãªã‚‰ãªã‹ã£ãŸå ´åˆã«ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
                instructionText.textContent = "100å›é”æˆï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ğŸ‰";
                clickCountParagraph.textContent = "ç´ æ™´ã‚‰ã—ã„ï¼"; // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¡¨ç¤ºã‚‚å¤‰ãˆã‚‹ãªã©
                contentWrapper.classList.remove('hidden'); // 100å›é”æˆã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å†è¡¨ç¤º
                videoPlayer.style.display = 'none'; // å‹•ç”»ã¯éš ã™ãªã©ã€ã‚²ãƒ¼ãƒ ã®çµ‚ã‚ã‚Šã«åˆã‚ã›ã¦èª¿æ•´
            } else if (clicks >= totalClicksGoal && !videoHasPlayed) { // (ã»ã¼ãªã„ã¯ãšã ãŒ)å‹•ç”»å†ç”Ÿå‰ã«100å›
                 instructionText.textContent = "100å›é”æˆï¼ (å‹•ç”»ã¯50å›ã§å†ç”Ÿã®ã¯ãšã§ã—ãŸ)";
                 contentWrapper.classList.remove('hidden');
            }
        });

        // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³çŠ¶æ…‹ã®å¤‰æ›´ã‚’ç›£è¦–
        function handleFullscreenChange() {
            if (!document.fullscreenElement && !document.webkitIsFullScreen && !document.mozFullScreen && !document.msFullscreenElement) {
                console.log("Exited fullscreen mode.");
                // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãŒè§£é™¤ã•ã‚ŒãŸã‚‰ã€å…ƒã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤ºçŠ¶æ…‹ã«æˆ»ã™
                // (ãŸã ã—ã€ã‚²ãƒ¼ãƒ ã®é€²è¡ŒçŠ¶æ³ã«ã‚ˆã£ã¦ã¯è¡¨ç¤ºã—ãŸã¾ã¾ãŒè‰¯ã„å ´åˆã‚‚ã‚ã‚‹)
                if (videoHasPlayed && clicks < totalClicksGoal) {
                     contentWrapper.classList.remove('hidden');
                     instructionText.textContent = "å‹•ç”»çµ‚äº†ã€‚ç¶šã‘ã¦100å›ã‚’ç›®æŒ‡ãã†ï¼";
                } else if (clicks >= totalClicksGoal) {
                    contentWrapper.classList.remove('hidden'); // æ—¢ã«100å›é”æˆæ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãš
                }
                // å‹•ç”»ã®å†ç”Ÿã‚’åœæ­¢ã—ãŸã‚Šã€è¡¨ç¤ºã‚’åˆ¶å¾¡ã—ãŸã‚Šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½
                // videoPlayer.pause();
                // videoPlayer.style.display = 'none';
            }
        }

        document.addEventListener('fullscreenchange', handleFullscreenChange);
        document.addEventListener('webkitfullscreenchange', handleFullscreenChange); // Chrome, Safari, Opera
        document.addEventListener('mozfullscreenchange', handleFullscreenChange);    // Firefox
        document.addEventListener('MSFullscreenChange', handleFullscreenChange);      // IE/Edge

        // å‹•ç”»ãŒçµ‚äº†ã—ãŸã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆ
        videoPlayer.addEventListener('ended', () => {
            console.log("Video has ended.");
            if (document.fullscreenElement || document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement) {
                document.exitFullscreen().catch(err => console.log(err)); // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚’çµ‚äº†
            }
            // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è§£é™¤å¾Œã®å‡¦ç†ã¯ handleFullscreenChange ã§è¡Œã‚ã‚Œã‚‹
            // ã“ã“ã§æ˜ç¤ºçš„ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å†è¡¨ç¤ºã—ã¦ã‚‚è‰¯ã„
            contentWrapper.classList.remove('hidden');
            if (clicks < totalClicksGoal) {
                instructionText.textContent = "å‹•ç”»çµ‚äº†ã€‚ç¶šã‘ã¦100å›ã‚’ç›®æŒ‡ãã†ï¼";
            } else {
                instructionText.textContent = "10
